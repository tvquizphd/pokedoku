from pypokedex.exceptions import PyPokedexHTTPError
from argparse import ArgumentParser
from util import set_config
import pypokedex as dex
import asyncio
import uvicorn
import signal
import sys

PORTS = {
    "client": 8080,
    "api": 8000
}

API_PORT = PORTS['api']
CLIENT_PORT = PORTS['client']

parser = ArgumentParser(
                    prog='Pokédoku API',
                    description='Test of Pokédoku API',
                    epilog=f'Using the PokéAPI')

DEX_DICT = {
    1: 'bulbasaur',
    2: 'ivysaur',
    3: 'venusaur',
    4: 'charmander',
    5: 'charmeleon',
    6: 'charizard',
    7: 'squirtle',
    8: 'wartortle',
    9: 'blastoise',
    10: 'caterpie',
    11: 'metapod',
    12: 'butterfree',
    13: 'weedle',
    14: 'kakuna',
    15: 'beedrill',
    16: 'pidgey',
    17: 'pidgeotto',
    18: 'pidgeot',
    19: 'rattata',
    20: 'raticate',
    21: 'spearow',
    22: 'fearow',
    23: 'ekans',
    24: 'arbok',
    25: 'pikachu',
    26: 'raichu',
    27: 'sandshrew',
    28: 'sandslash',
    29: 'nidoran-f',
    30: 'nidorina',
    31: 'nidoqueen',
    32: 'nidoran-m',
    33: 'nidorino',
    34: 'nidoking',
    35: 'clefairy',
    36: 'clefable',
    37: 'vulpix',
    38: 'ninetales',
    39: 'jigglypuff',
    40: 'wigglytuff',
    41: 'zubat',
    42: 'golbat',
    43: 'oddish',
    44: 'gloom',
    45: 'vileplume',
    46: 'paras',
    47: 'parasect',
    48: 'venonat',
    49: 'venomoth',
    50: 'diglett',
    51: 'dugtrio',
    52: 'meowth',
    53: 'persian',
    54: 'psyduck',
    55: 'golduck',
    56: 'mankey',
    57: 'primeape',
    58: 'growlithe',
    59: 'arcanine',
    60: 'poliwag',
    61: 'poliwhirl',
    62: 'poliwrath',
    63: 'abra',
    64: 'kadabra',
    65: 'alakazam',
    66: 'machop',
    67: 'machoke',
    68: 'machamp',
    69: 'bellsprout',
    70: 'weepinbell',
    71: 'victreebel',
    72: 'tentacool',
    73: 'tentacruel',
    74: 'geodude',
    75: 'graveler',
    76: 'golem',
    77: 'ponyta',
    78: 'rapidash',
    79: 'slowpoke',
    80: 'slowbro',
    81: 'magnemite',
    82: 'magneton',
    83: 'farfetchd',
    84: 'doduo',
    85: 'dodrio',
    86: 'seel',
    87: 'dewgong',
    88: 'grimer',
    89: 'muk',
    90: 'shellder',
    91: 'cloyster',
    92: 'gastly',
    93: 'haunter',
    94: 'gengar',
    95: 'onix',
    96: 'drowzee',
    97: 'hypno',
    98: 'krabby',
    99: 'kingler',
    100: 'voltorb',
    101: 'electrode',
    102: 'exeggcute',
    103: 'exeggutor',
    104: 'cubone',
    105: 'marowak',
    106: 'hitmonlee',
    107: 'hitmonchan',
    108: 'lickitung',
    109: 'koffing',
    110: 'weezing',
    111: 'rhyhorn',
    112: 'rhydon',
    113: 'chansey',
    114: 'tangela',
    115: 'kangaskhan',
    116: 'horsea',
    117: 'seadra',
    118: 'goldeen',
    119: 'seaking',
    120: 'staryu',
    121: 'starmie',
    122: 'mr-mime',
    123: 'scyther',
    124: 'jynx',
    125: 'electabuzz',
    126: 'magmar',
    127: 'pinsir',
    128: 'tauros',
    129: 'magikarp',
    130: 'gyarados',
    131: 'lapras',
    132: 'ditto',
    133: 'eevee',
    134: 'vaporeon',
    135: 'jolteon',
    136: 'flareon',
    137: 'porygon',
    138: 'omanyte',
    139: 'omastar',
    140: 'kabuto',
    141: 'kabutops',
    142: 'aerodactyl',
    143: 'snorlax',
    144: 'articuno',
    145: 'zapdos',
    146: 'moltres',
    147: 'dratini',
    148: 'dragonair',
    149: 'dragonite',
    150: 'mewtwo',
    151: 'mew',
    152: 'chikorita',
    153: 'bayleef',
    154: 'meganium',
    155: 'cyndaquil',
    156: 'quilava',
    157: 'typhlosion',
    158: 'totodile',
    159: 'croconaw',
    160: 'feraligatr',
    161: 'sentret',
    162: 'furret',
    163: 'hoothoot',
    164: 'noctowl',
    165: 'ledyba',
    166: 'ledian',
    167: 'spinarak',
    168: 'ariados',
    169: 'crobat',
    170: 'chinchou',
    171: 'lanturn',
    172: 'pichu',
    173: 'cleffa',
    174: 'igglybuff',
    175: 'togepi',
    176: 'togetic',
    177: 'natu',
    178: 'xatu',
    179: 'mareep',
    180: 'flaaffy',
    181: 'ampharos',
    182: 'bellossom',
    183: 'marill',
    184: 'azumarill',
    185: 'sudowoodo',
    186: 'politoed',
    187: 'hoppip',
    188: 'skiploom',
    189: 'jumpluff',
    190: 'aipom',
    191: 'sunkern',
    192: 'sunflora',
    193: 'yanma',
    194: 'wooper',
    195: 'quagsire',
    196: 'espeon',
    197: 'umbreon',
    198: 'murkrow',
    199: 'slowking',
    200: 'misdreavus',
    201: 'unown',
    202: 'wobbuffet',
    203: 'girafarig',
    204: 'pineco',
    205: 'forretress',
    206: 'dunsparce',
    207: 'gligar',
    208: 'steelix',
    209: 'snubbull',
    210: 'granbull',
    211: 'qwilfish',
    212: 'scizor',
    213: 'shuckle',
    214: 'heracross',
    215: 'sneasel',
    216: 'teddiursa',
    217: 'ursaring',
    218: 'slugma',
    219: 'magcargo',
    220: 'swinub',
    221: 'piloswine',
    222: 'corsola',
    223: 'remoraid',
    224: 'octillery',
    225: 'delibird',
    226: 'mantine',
    227: 'skarmory',
    228: 'houndour',
    229: 'houndoom',
    230: 'kingdra',
    231: 'phanpy',
    232: 'donphan',
    233: 'porygon2',
    234: 'stantler',
    235: 'smeargle',
    236: 'tyrogue',
    237: 'hitmontop',
    238: 'smoochum',
    239: 'elekid',
    240: 'magby',
    241: 'miltank',
    242: 'blissey',
    243: 'raikou',
    244: 'entei',
    245: 'suicune',
    246: 'larvitar',
    247: 'pupitar',
    248: 'tyranitar',
    249: 'lugia',
    250: 'ho-oh',
    251: 'celebi',
    252: 'treecko',
    253: 'grovyle',
    254: 'sceptile',
    255: 'torchic',
    256: 'combusken',
    257: 'blaziken',
    258: 'mudkip',
    259: 'marshtomp',
    260: 'swampert',
    261: 'poochyena',
    262: 'mightyena',
    263: 'zigzagoon',
    264: 'linoone',
    265: 'wurmple',
    266: 'silcoon',
    267: 'beautifly',
    268: 'cascoon',
    269: 'dustox',
    270: 'lotad',
    271: 'lombre',
    272: 'ludicolo',
    273: 'seedot',
    274: 'nuzleaf',
    275: 'shiftry',
    276: 'taillow',
    277: 'swellow',
    278: 'wingull',
    279: 'pelipper',
    280: 'ralts',
    281: 'kirlia',
    282: 'gardevoir',
    283: 'surskit',
    284: 'masquerain',
    285: 'shroomish',
    286: 'breloom',
    287: 'slakoth',
    288: 'vigoroth',
    289: 'slaking',
    290: 'nincada',
    291: 'ninjask',
    292: 'shedinja',
    293: 'whismur',
    294: 'loudred',
    295: 'exploud',
    296: 'makuhita',
    297: 'hariyama',
    298: 'azurill',
    299: 'nosepass',
    300: 'skitty',
    301: 'delcatty',
    302: 'sableye',
    303: 'mawile',
    304: 'aron',
    305: 'lairon',
    306: 'aggron',
    307: 'meditite',
    308: 'medicham',
    309: 'electrike',
    310: 'manectric',
    311: 'plusle',
    312: 'minun',
    313: 'volbeat',
    314: 'illumise',
    315: 'roselia',
    316: 'gulpin',
    317: 'swalot',
    318: 'carvanha',
    319: 'sharpedo',
    320: 'wailmer',
    321: 'wailord',
    322: 'numel',
    323: 'camerupt',
    324: 'torkoal',
    325: 'spoink',
    326: 'grumpig',
    327: 'spinda',
    328: 'trapinch',
    329: 'vibrava',
    330: 'flygon',
    331: 'cacnea',
    332: 'cacturne',
    333: 'swablu',
    334: 'altaria',
    335: 'zangoose',
    336: 'seviper',
    337: 'lunatone',
    338: 'solrock',
    339: 'barboach',
    340: 'whiscash',
    341: 'corphish',
    342: 'crawdaunt',
    343: 'baltoy',
    344: 'claydol',
    345: 'lileep',
    346: 'cradily',
    347: 'anorith',
    348: 'armaldo',
    349: 'feebas',
    350: 'milotic',
    351: 'castform',
    352: 'kecleon',
    353: 'shuppet',
    354: 'banette',
    355: 'duskull',
    356: 'dusclops',
    357: 'tropius',
    358: 'chimecho',
    359: 'absol',
    360: 'wynaut',
    361: 'snorunt',
    362: 'glalie',
    363: 'spheal',
    364: 'sealeo',
    365: 'walrein',
    366: 'clamperl',
    367: 'huntail',
    368: 'gorebyss',
    369: 'relicanth',
    370: 'luvdisc',
    371: 'bagon',
    372: 'shelgon',
    373: 'salamence',
    374: 'beldum',
    375: 'metang',
    376: 'metagross',
    377: 'regirock',
    378: 'regice',
    379: 'registeel',
    380: 'latias',
    381: 'latios',
    382: 'kyogre',
    383: 'groudon',
    384: 'rayquaza',
    385: 'jirachi',
    386: 'deoxys',
    387: 'turtwig',
    388: 'grotle',
    389: 'torterra',
    390: 'chimchar',
    391: 'monferno',
    392: 'infernape',
    393: 'piplup',
    394: 'prinplup',
    395: 'empoleon',
    396: 'starly',
    397: 'staravia',
    398: 'staraptor',
    399: 'bidoof',
    400: 'bibarel',
    401: 'kricketot',
    402: 'kricketune',
    403: 'shinx',
    404: 'luxio',
    405: 'luxray',
    406: 'budew',
    407: 'roserade',
    408: 'cranidos',
    409: 'rampardos',
    410: 'shieldon',
    411: 'bastiodon',
    412: 'burmy',
    413: 'wormadam',
    414: 'mothim',
    415: 'combee',
    416: 'vespiquen',
    417: 'pachirisu',
    418: 'buizel',
    419: 'floatzel',
    420: 'cherubi',
    421: 'cherrim',
    422: 'shellos',
    423: 'gastrodon',
    424: 'ambipom',
    425: 'drifloon',
    426: 'drifblim',
    427: 'buneary',
    428: 'lopunny',
    429: 'mismagius',
    430: 'honchkrow',
    431: 'glameow',
    432: 'purugly',
    433: 'chingling',
    434: 'stunky',
    435: 'skuntank',
    436: 'bronzor',
    437: 'bronzong',
    438: 'bonsly',
    439: 'mime-jr',
    440: 'happiny',
    441: 'chatot',
    442: 'spiritomb',
    443: 'gible',
    444: 'gabite',
    445: 'garchomp',
    446: 'munchlax',
    447: 'riolu',
    448: 'lucario',
    449: 'hippopotas',
    450: 'hippowdon',
    451: 'skorupi',
    452: 'drapion',
    453: 'croagunk',
    454: 'toxicroak',
    455: 'carnivine',
    456: 'finneon',
    457: 'lumineon',
    458: 'mantyke',
    459: 'snover',
    460: 'abomasnow',
    461: 'weavile',
    462: 'magnezone',
    463: 'lickilicky',
    464: 'rhyperior',
    465: 'tangrowth',
    466: 'electivire',
    467: 'magmortar',
    468: 'togekiss',
    469: 'yanmega',
    470: 'leafeon',
    471: 'glaceon',
    472: 'gliscor',
    473: 'mamoswine',
    474: 'porygon-z',
    475: 'gallade',
    476: 'probopass',
    477: 'dusknoir',
    478: 'froslass',
    479: 'rotom',
    480: 'uxie',
    481: 'mesprit',
    482: 'azelf',
    483: 'dialga',
    484: 'palkia',
    485: 'heatran',
    486: 'regigigas',
    487: 'giratina',
    488: 'cresselia',
    489: 'phione',
    490: 'manaphy',
    491: 'darkrai',
    492: 'shaymin',
    493: 'arceus',
    494: 'victini',
    495: 'snivy',
    496: 'servine',
    497: 'serperior',
    498: 'tepig',
    499: 'pignite',
    500: 'emboar',
    501: 'oshawott',
    502: 'dewott',
    503: 'samurott',
    504: 'patrat',
    505: 'watchog',
    506: 'lillipup',
    507: 'herdier',
    508: 'stoutland',
    509: 'purrloin',
    510: 'liepard',
    511: 'pansage',
    512: 'simisage',
    513: 'pansear',
    514: 'simisear',
    515: 'panpour',
    516: 'simipour',
    517: 'munna',
    518: 'musharna',
    519: 'pidove',
    520: 'tranquill',
    521: 'unfezant',
    522: 'blitzle',
    523: 'zebstrika',
    524: 'roggenrola',
    525: 'boldore',
    526: 'gigalith',
    527: 'woobat',
    528: 'swoobat',
    529: 'drilbur',
    530: 'excadrill',
    531: 'audino',
    532: 'timburr',
    533: 'gurdurr',
    534: 'conkeldurr',
    535: 'tympole',
    536: 'palpitoad',
    537: 'seismitoad',
    538: 'throh',
    539: 'sawk',
    540: 'sewaddle',
    541: 'swadloon',
    542: 'leavanny',
    543: 'venipede',
    544: 'whirlipede',
    545: 'scolipede',
    546: 'cottonee',
    547: 'whimsicott',
    548: 'petilil',
    549: 'lilligant',
    550: 'basculin',
    551: 'sandile',
    552: 'krokorok',
    553: 'krookodile',
    554: 'darumaka',
    555: 'darmanitan',
    556: 'maractus',
    557: 'dwebble',
    558: 'crustle',
    559: 'scraggy',
    560: 'scrafty',
    561: 'sigilyph',
    562: 'yamask',
    563: 'cofagrigus',
    564: 'tirtouga',
    565: 'carracosta',
    566: 'archen',
    567: 'archeops',
    568: 'trubbish',
    569: 'garbodor',
    570: 'zorua',
    571: 'zoroark',
    572: 'minccino',
    573: 'cinccino',
    574: 'gothita',
    575: 'gothorita',
    576: 'gothitelle',
    577: 'solosis',
    578: 'duosion',
    579: 'reuniclus',
    580: 'ducklett',
    581: 'swanna',
    582: 'vanillite',
    583: 'vanillish',
    584: 'vanilluxe',
    585: 'deerling',
    586: 'sawsbuck',
    587: 'emolga',
    588: 'karrablast',
    589: 'escavalier',
    590: 'foongus',
    591: 'amoonguss',
    592: 'frillish',
    593: 'jellicent',
    594: 'alomomola',
    595: 'joltik',
    596: 'galvantula',
    597: 'ferroseed',
    598: 'ferrothorn',
    599: 'klink',
    600: 'klang',
    601: 'klinklang',
    602: 'tynamo',
    603: 'eelektrik',
    604: 'eelektross',
    605: 'elgyem',
    606: 'beheeyem',
    607: 'litwick',
    608: 'lampent',
    609: 'chandelure',
    610: 'axew',
    611: 'fraxure',
    612: 'haxorus',
    613: 'cubchoo',
    614: 'beartic',
    615: 'cryogonal',
    616: 'shelmet',
    617: 'accelgor',
    618: 'stunfisk',
    619: 'mienfoo',
    620: 'mienshao',
    621: 'druddigon',
    622: 'golett',
    623: 'golurk',
    624: 'pawniard',
    625: 'bisharp',
    626: 'bouffalant',
    627: 'rufflet',
    628: 'braviary',
    629: 'vullaby',
    630: 'mandibuzz',
    631: 'heatmor',
    632: 'durant',
    633: 'deino',
    634: 'zweilous',
    635: 'hydreigon',
    636: 'larvesta',
    637: 'volcarona',
    638: 'cobalion',
    639: 'terrakion',
    640: 'virizion',
    641: 'tornadus',
    642: 'thundurus',
    643: 'reshiram',
    644: 'zekrom',
    645: 'landorus',
    646: 'kyurem',
    647: 'keldeo',
    648: 'meloetta',
    649: 'genesect',
    650: 'chespin',
    651: 'quilladin',
    652: 'chesnaught',
    653: 'fennekin',
    654: 'braixen',
    655: 'delphox',
    656: 'froakie',
    657: 'frogadier',
    658: 'greninja',
    659: 'bunnelby',
    660: 'diggersby',
    661: 'fletchling',
    662: 'fletchinder',
    663: 'talonflame',
    664: 'scatterbug',
    665: 'spewpa',
    666: 'vivillon',
    667: 'litleo',
    668: 'pyroar',
    669: 'flabebe',
    670: 'floette',
    671: 'florges',
    672: 'skiddo',
    673: 'gogoat',
    674: 'pancham',
    675: 'pangoro',
    676: 'furfrou',
    677: 'espurr',
    678: 'meowstic',
    679: 'honedge',
    680: 'doublade',
    681: 'aegislash',
    682: 'spritzee',
    683: 'aromatisse',
    684: 'swirlix',
    685: 'slurpuff',
    686: 'inkay',
    687: 'malamar',
    688: 'binacle',
    689: 'barbaracle',
    690: 'skrelp',
    691: 'dragalge',
    692: 'clauncher',
    693: 'clawitzer',
    694: 'helioptile',
    695: 'heliolisk',
    696: 'tyrunt',
    697: 'tyrantrum',
    698: 'amaura',
    699: 'aurorus',
    700: 'sylveon',
    701: 'hawlucha',
    702: 'dedenne',
    703: 'carbink',
    704: 'goomy',
    705: 'sliggoo',
    706: 'goodra',
    707: 'klefki',
    708: 'phantump',
    709: 'trevenant',
    710: 'pumpkaboo',
    711: 'gourgeist',
    712: 'bergmite',
    713: 'avalugg',
    714: 'noibat',
    715: 'noivern',
    716: 'xerneas',
    717: 'yveltal',
    718: 'zygarde',
    719: 'diancie',
    720: 'hoopa',
    721: 'volcanion',
    722: 'rowlet',
    723: 'dartrix',
    724: 'decidueye',
    725: 'litten',
    726: 'torracat',
    727: 'incineroar',
    728: 'popplio',
    729: 'brionne',
    730: 'primarina',
    731: 'pikipek',
    732: 'trumbeak',
    733: 'toucannon',
    734: 'yungoos',
    735: 'gumshoos',
    736: 'grubbin',
    737: 'charjabug',
    738: 'vikavolt',
    739: 'crabrawler',
    740: 'crabominable',
    741: 'oricorio',
    742: 'cutiefly',
    743: 'ribombee',
    744: 'rockruff',
    745: 'lycanroc',
    746: 'wishiwashi',
    747: 'mareanie',
    748: 'toxapex',
    749: 'mudbray',
    750: 'mudsdale',
    751: 'dewpider',
    752: 'araquanid',
    753: 'fomantis',
    754: 'lurantis',
    755: 'morelull',
    756: 'shiinotic',
    757: 'salandit',
    758: 'salazzle',
    759: 'stufful',
    760: 'bewear',
    761: 'bounsweet',
    762: 'steenee',
    763: 'tsareena',
    764: 'comfey',
    765: 'oranguru',
    766: 'passimian',
    767: 'wimpod',
    768: 'golisopod',
    769: 'sandygast',
    770: 'palossand',
    771: 'pyukumuku',
    772: 'type-null',
    773: 'silvally',
    774: 'minior',
    775: 'komala',
    776: 'turtonator',
    777: 'togedemaru',
    778: 'mimikyu',
    779: 'bruxish',
    780: 'drampa',
    781: 'dhelmise',
    782: 'jangmo-o',
    783: 'hakamo-o',
    784: 'kommo-o',
    785: 'tapu-koko',
    786: 'tapu-lele',
    787: 'tapu-bulu',
    788: 'tapu-fini',
    789: 'cosmog',
    790: 'cosmoem',
    791: 'solgaleo',
    792: 'lunala',
    793: 'nihilego',
    794: 'buzzwole',
    795: 'pheromosa',
    796: 'xurkitree',
    797: 'celesteela',
    798: 'kartana',
    799: 'guzzlord',
    800: 'necrozma',
    801: 'magearna',
    802: 'marshadow',
    803: 'poipole',
    804: 'naganadel',
    805: 'stakataka',
    806: 'blacephalon',
    807: 'zeraora',
    808: 'meltan',
    809: 'melmetal',
    810: 'grookey',
    811: 'thwackey',
    812: 'rillaboom',
    813: 'scorbunny',
    814: 'raboot',
    815: 'cinderace',
    816: 'sobble',
    817: 'drizzile',
    818: 'inteleon',
    819: 'skwovet',
    820: 'greedent',
    821: 'rookidee',
    822: 'corvisquire',
    823: 'corviknight',
    824: 'blipbug',
    825: 'dottler',
    826: 'orbeetle',
    827: 'nickit',
    828: 'thievul',
    829: 'gossifleur',
    830: 'eldegoss',
    831: 'wooloo',
    832: 'dubwool',
    833: 'chewtle',
    834: 'drednaw',
    835: 'yamper',
    836: 'boltund',
    837: 'rolycoly',
    838: 'carkol',
    839: 'coalossal',
    840: 'applin',
    841: 'flapple',
    842: 'appletun',
    843: 'silicobra',
    844: 'sandaconda',
    845: 'cramorant',
    846: 'arrokuda',
    847: 'barraskewda',
    848: 'toxel',
    849: 'toxtricity',
    850: 'sizzlipede',
    851: 'centiskorch',
    852: 'clobbopus',
    853: 'grapploct',
    854: 'sinistea',
    855: 'polteageist',
    856: 'hatenna',
    857: 'hattrem',
    858: 'hatterene',
    859: 'impidimp',
    860: 'morgrem',
    861: 'grimmsnarl',
    862: 'obstagoon',
    863: 'perrserker',
    864: 'cursola',
    865: 'sirfetchd',
    866: 'mr-rime',
    867: 'runerigus',
    868: 'milcery',
    869: 'alcremie',
    870: 'falinks',
    871: 'pincurchin',
    872: 'snom',
    873: 'frosmoth',
    874: 'stonjourner',
    875: 'eiscue',
    876: 'indeedee',
    877: 'morpeko',
    878: 'cufant',
    879: 'copperajah',
    880: 'dracozolt',
    881: 'arctozolt',
    882: 'dracovish',
    883: 'arctovish',
    884: 'duraludon',
    885: 'dreepy',
    886: 'drakloak',
    887: 'dragapult',
    888: 'zacian',
    889: 'zamazenta',
    890: 'eternatus',
    891: 'kubfu',
    892: 'urshifu',
    893: 'zarude',
    894: 'regieleki',
    895: 'regidrago',
    896: 'glastrier',
    897: 'spectrier',
    898: 'calyrex',
    899: 'wyrdeer',
    900: 'kleavor',
    901: 'ursaluna',
    902: 'basculegion',
    903: 'sneasler',
    904: 'overqwil',
    905: 'enamorus',
    906: 'sprigatito',
    907: 'floragato',
    908: 'meowscarada',
    909: 'fuecoco',
    910: 'crocalor',
    911: 'skeledirge',
    912: 'quaxly',
    913: 'quaxwell',
    914: 'quaquaval',
    915: 'lechonk',
    916: 'oinkologne',
    917: 'tarountula',
    918: 'spidops',
    919: 'nymble',
    920: 'lokix',
    921: 'pawmi',
    922: 'pawmo',
    923: 'pawmot',
    924: 'tandemaus',
    925: 'maushold',
    926: 'fidough',
    927: 'dachsbun',
    928: 'smoliv',
    929: 'dolliv',
    930: 'arboliva',
    931: 'squawkabilly',
    932: 'nacli',
    933: 'naclstack',
    934: 'garganacl',
    935: 'charcadet',
    936: 'armarouge',
    937: 'ceruledge',
    938: 'tadbulb',
    939: 'bellibolt',
    940: 'wattrel',
    941: 'kilowattrel',
    942: 'maschiff',
    943: 'mabosstiff',
    944: 'shroodle',
    945: 'grafaiai',
    946: 'bramblin',
    947: 'brambleghast',
    948: 'toedscool',
    949: 'toedscruel',
    950: 'klawf',
    951: 'capsakid',
    952: 'scovillain',
    953: 'rellor',
    954: 'rabsca',
    955: 'flittle',
    956: 'espathra',
    957: 'tinkatink',
    958: 'tinkatuff',
    959: 'tinkaton',
    960: 'wiglett',
    961: 'wugtrio',
    962: 'bombirdier',
    963: 'finizen',
    964: 'palafin',
    965: 'varoom',
    966: 'revavroom',
    967: 'cyclizar',
    968: 'orthworm',
    969: 'glimmet',
    970: 'glimmora',
    971: 'greavard',
    972: 'houndstone',
    973: 'flamigo',
    974: 'cetoddle',
    975: 'cetitan',
    976: 'veluza',
    977: 'dondozo',
    978: 'tatsugiri',
    979: 'annihilape',
    980: 'clodsire',
    981: 'farigiraf',
    982: 'dudunsparce',
    983: 'kingambit',
    984: 'great-tusk',
    985: 'scream-tail',
    986: 'brute-bonnet',
    987: 'flutter-mane',
    988: 'slither-wing',
    989: 'sandy-shocks',
    990: 'iron-treads',
    991: 'iron-bundle',
    992: 'iron-hands',
    993: 'iron-jugulis',
    994: 'iron-moth',
    995: 'iron-thorns',
    996: 'frigibax',
    997: 'arctibax',
    998: 'baxcalibur',
    999: 'gimmighoul',
    1000: 'gholdengo',
    1001: 'wo-chien',
    1002: 'chien-pao',
    1003: 'ting-lu',
    1004: 'chi-yu',
    1005: 'roaring-moon',
    1006: 'iron-valiant',
    1007: 'koraidon',
    1008: 'miraidon',
    1009: 'walking-wake',
    1010: 'iron-leaves',
    1011: 'dipplin',
    1012: 'poltchageist',
    1013: 'sinistcha',
    1014: 'okidogi',
    1015: 'munkidori',
    1016: 'fezandipiti',
    1017: 'ogerpon'
}

THREE_GRAMS = {
    'bul': [1],
    'ivy': [2],
    'ven': [3, 48, 49, 543],
    'cha': [4, 5, 6, 113, 441, 609, 737, 935],
    'squ': [7, 931],
    'war': [8],
    'bla': [9, 257, 806],
    'cat': [10],
    'met': [11, 375, 376],
    'but': [12],
    'wee': [13, 70, 110],
    'kak': [14],
    'bee': [15],
    'pid': [16, 17, 18, 519],
    'rat': [19, 20],
    'spe': [21, 665, 897],
    'fea': [22],
    'eka': [23],
    'arb': [24, 930],
    'pik': [25, 731],
    'rai': [26, 243],
    'san': [27, 28, 551, 769, 844, 989],
    'nid': [29, 30, 31, 32, 33, 34],
    'cle': [35, 36, 173],
    'vul': [37, 629],
    'nin': [38, 290, 291],
    'jig': [39],
    'wig': [40, 960],
    'zub': [41],
    'gol': [42, 55, 76, 118, 622, 623, 768],
    'odd': [43],
    'glo': [44],
    'vil': [45],
    'par': [46, 47],
    'dig': [50, 660],
    'dug': [51],
    'meo': [52, 678, 908],
    'per': [53, 863],
    'psy': [54],
    'man': [56, 226, 310, 458, 490, 630],
    'pri': [57, 394, 730],
    'gro': [58, 253, 383, 388, 810],
    'arc': [59, 493, 566, 567, 881, 883, 997],
    'pol': [60, 61, 62, 186, 855, 1012],
    'abr': [63],
    'kad': [64],
    'ala': [65],
    'mac': [66, 67, 68],
    'bel': [69, 182, 374, 939],
    'vic': [71, 494],
    'ten': [72, 73],
    'geo': [74],
    'gra': [75, 210, 853, 945],
    'pon': [77],
    'rap': [78],
    'slo': [79, 80, 199],
    'mag': [81, 82, 126, 129, 219, 240, 462, 467, 801],
    'far': [83, 981],
    'dod': [84, 85],
    'see': [86, 273],
    'dew': [87, 502, 751],
    'gri': [88, 861],
    'muk': [89],
    'she': [90, 292, 372, 422, 616],
    'clo': [91, 852, 980],
    'gas': [92, 423],
    'hau': [93],
    'gen': [94, 649],
    'oni': [95],
    'dro': [96],
    'hyp': [97],
    'kra': [98],
    'kin': [99, 230, 983],
    'vol': [100, 313, 637, 721],
    'ele': [101, 125, 239, 309, 466],
    'exe': [102, 103],
    'cub': [104, 613],
    'mar': [105, 179, 183, 259, 556, 747, 802],
    'hit': [106, 107, 237],
    'lic': [108, 463],
    'kof': [109],
    'rhy': [111, 112, 464],
    'tan': [114, 465, 924],
    'kan': [115],
    'hor': [116],
    'sea': [117, 119, 364],
    'sta': [120, 121, 234, 396, 397, 398, 805],
    'mr-': [122, 866],
    'scy': [123],
    'jyn': [124],
    'pin': [127, 204, 871],
    'tau': [128],
    'gya': [130],
    'lap': [131],
    'dit': [132],
    'eev': [133],
    'vap': [134],
    'jol': [135, 595],
    'fla': [136, 180, 669, 841, 973],
    'por': [137, 233, 474],
    'oma': [138, 139],
    'kab': [140, 141],
    'aer': [142],
    'sno': [143, 361, 459, 872],
    'art': [144],
    'zap': [145],
    'mol': [146],
    'dra': [147, 148, 149, 452, 691, 780, 880, 882, 886, 887],
    'mew': [150, 151],
    'chi': [152, 170, 358, 390, 433, 1002, 1004],
    'bay': [153],
    'meg': [154],
    'cyn': [155],
    'qui': [156, 651],
    'typ': [157, 772],
    'tot': [158],
    'cro': [159, 169, 453, 910],
    'fer': [160, 597, 598],
    'sen': [161],
    'fur': [162, 676],
    'hoo': [163, 720],
    'noc': [164],
    'led': [165, 166],
    'spi': [167, 327, 442, 918],
    'ari': [168],
    'lan': [171, 645],
    'pic': [172],
    'igg': [174],
    'tog': [175, 176, 468, 777],
    'nat': [177],
    'xat': [178],
    'amp': [181],
    'azu': [184, 298],
    'sud': [185],
    'hop': [187],
    'ski': [188, 300, 672],
    'jum': [189],
    'aip': [190],
    'sun': [191, 192],
    'yan': [193, 469],
    'woo': [194, 527, 831],
    'qua': [195, 912, 913, 914],
    'esp': [196, 677, 956],
    'umb': [197],
    'mur': [198],
    'mis': [200, 429],
    'uno': [201],
    'wob': [202],
    'gir': [203, 487],
    'for': [205],
    'dun': [206],
    'gli': [207, 472, 969, 970],
    'ste': [208, 762],
    'snu': [209],
    'qwi': [211],
    'sci': [212],
    'shu': [213, 353],
    'her': [214, 507],
    'sne': [215, 903],
    'ted': [216],
    'urs': [217, 892, 901],
    'slu': [218, 685],
    'swi': [220, 684],
    'pil': [221],
    'cor': [222, 341, 822, 823],
    'rem': [223],
    'oct': [224],
    'del': [225, 301, 655],
    'ska': [227],
    'hou': [228, 229, 972],
    'pha': [231, 708],
    'don': [232, 977],
    'sme': [235],
    'tyr': [236, 248, 696, 697],
    'smo': [238, 928],
    'mil': [241, 350, 868],
    'bli': [242, 522, 824],
    'ent': [244],
    'sui': [245],
    'lar': [246, 636],
    'pup': [247],
    'lug': [249],
    'ho-': [250],
    'cel': [251, 797],
    'tre': [252, 709],
    'sce': [254],
    'tor': [255, 324, 389, 641, 726],
    'com': [256, 415, 764],
    'mud': [258, 749, 750],
    'swa': [260, 317, 333, 541, 581],
    'poo': [261],
    'mig': [262],
    'zig': [263],
    'lin': [264],
    'wur': [265],
    'sil': [266, 773, 843],
    'bea': [267, 614],
    'cas': [268, 351],
    'dus': [269, 355, 356, 477],
    'lot': [270],
    'lom': [271],
    'lud': [272],
    'nuz': [274],
    'shi': [275, 403, 410, 756],
    'tai': [276],
    'swe': [277],
    'win': [278],
    'pel': [279],
    'ral': [280],
    'kir': [281],
    'gar': [282, 445, 569, 934],
    'sur': [283],
    'mas': [284, 942],
    'shr': [285, 944],
    'bre': [286],
    'sla': [287, 289],
    'vig': [288],
    'whi': [293, 340, 544, 547],
    'lou': [294],
    'exp': [295],
    'mak': [296],
    'har': [297],
    'nos': [299],
    'sab': [302],
    'maw': [303],
    'aro': [304, 683],
    'lai': [305],
    'agg': [306],
    'med': [307, 308],
    'plu': [311],
    'min': [312, 572, 774],
    'ill': [314],
    'ros': [315, 407],
    'gul': [316],
    'car': [318, 455, 565, 703, 838],
    'sha': [319, 492],
    'wai': [320, 321],
    'num': [322],
    'cam': [323],
    'spo': [325],
    'gru': [326, 736],
    'tra': [328, 520],
    'vib': [329],
    'fly': [330],
    'cac': [331, 332],
    'alt': [334],
    'zan': [335],
    'sev': [336],
    'lun': [337, 792],
    'sol': [338, 577, 791],
    'bar': [339, 689, 847],
    'cra': [342, 346, 408, 739, 740, 845],
    'bal': [343],
    'cla': [344, 366, 692, 693],
    'lil': [345, 506, 549],
    'ano': [347],
    'arm': [348, 936],
    'fee': [349],
    'kec': [352],
    'ban': [354],
    'tro': [357],
    'abs': [359],
    'wyn': [360],
    'gla': [362, 431, 471, 896],
    'sph': [363],
    'wal': [365, 1009],
    'hun': [367],
    'gor': [368],
    'rel': [369, 953],
    'luv': [370],
    'bag': [371],
    'sal': [373, 757, 758],
    'reg': [377, 378, 379, 486, 894, 895],
    'lat': [380, 381],
    'kyo': [382],
    'ray': [384],
    'jir': [385],
    'deo': [386],
    'tur': [387, 776],
    'mon': [391],
    'inf': [392],
    'pip': [393],
    'emp': [395],
    'bid': [399],
    'bib': [400],
    'kri': [401, 402],
    'lux': [404, 405],
    'bud': [406],
    'ram': [409],
    'bas': [411, 550, 902],
    'bur': [412],
    'wor': [413],
    'mot': [414],
    'ves': [416],
    'pac': [417],
    'bui': [418],
    'flo': [419, 670, 671, 907],
    'che': [420, 421, 650, 652, 833],
    'amb': [424],
    'dri': [425, 426, 529, 817],
    'bun': [427, 659],
    'lop': [428],
    'hon': [430, 679],
    'pur': [432, 509],
    'stu': [434, 618, 759],
    'sku': [435],
    'bro': [436, 437],
    'bon': [438],
    'mim': [439, 778],
    'hap': [440],
    'gib': [443],
    'gab': [444],
    'mun': [446, 517, 1015],
    'rio': [447],
    'luc': [448],
    'hip': [449, 450],
    'sko': [451],
    'tox': [454, 748, 848, 849],
    'fin': [456, 963],
    'lum': [457],
    'abo': [460],
    'wea': [461],
    'lea': [470, 542],
    'mam': [473],
    'gal': [475, 596],
    'pro': [476],
    'fro': [478, 656, 657, 873],
    'rot': [479],
    'uxi': [480],
    'mes': [481],
    'aze': [482],
    'dia': [483, 719],
    'pal': [484, 536, 770, 964],
    'hea': [485, 631],
    'cre': [488],
    'phi': [489],
    'dar': [491, 554, 555, 723],
    'sni': [495],
    'ser': [496, 497],
    'tep': [498],
    'pig': [499],
    'emb': [500],
    'osh': [501],
    'sam': [503],
    'pat': [504],
    'wat': [505, 940],
    'sto': [508, 874],
    'lie': [510],
    'pan': [511, 513, 515, 674, 675],
    'sim': [512, 514, 516],
    'mus': [518],
    'unf': [521],
    'zeb': [523],
    'rog': [524],
    'bol': [525, 836],
    'gig': [526],
    'swo': [528],
    'exc': [530],
    'aud': [531],
    'tim': [532],
    'gur': [533],
    'con': [534],
    'tym': [535],
    'sei': [537],
    'thr': [538],
    'saw': [539, 586],
    'sew': [540],
    'sco': [545, 813, 952],
    'cot': [546],
    'pet': [548],
    'kro': [552, 553],
    'dwe': [557],
    'cru': [558],
    'scr': [559, 560, 985],
    'sig': [561],
    'yam': [562, 835],
    'cof': [563],
    'tir': [564],
    'tru': [568, 732],
    'zor': [570, 571],
    'cin': [573, 815],
    'got': [574, 575, 576],
    'duo': [578],
    'reu': [579],
    'duc': [580],
    'van': [582, 583, 584],
    'dee': [585],
    'emo': [587],
    'kar': [588, 798],
    'esc': [589],
    'foo': [590],
    'amo': [591],
    'fri': [592, 996],
    'jel': [593],
    'alo': [594],
    'kli': [599, 601],
    'kla': [600, 950],
    'tyn': [602],
    'eel': [603, 604],
    'elg': [605],
    'beh': [606],
    'lit': [607, 667, 725],
    'lam': [608],
    'axe': [610],
    'fra': [611],
    'hax': [612],
    'cry': [615],
    'acc': [617],
    'mie': [619, 620],
    'dru': [621],
    'paw': [624, 921, 922, 923],
    'bis': [625],
    'bou': [626, 761],
    'ruf': [627],
    'bra': [628, 654, 946, 947],
    'dur': [632, 884],
    'dei': [633],
    'zwe': [634],
    'hyd': [635],
    'cob': [638],
    'ter': [639],
    'vir': [640],
    'thu': [642],
    'res': [643],
    'zek': [644],
    'kyu': [646],
    'kel': [647],
    'mel': [648, 808, 809],
    'fen': [653],
    'gre': [658, 820, 971, 984],
    'fle': [661, 662],
    'tal': [663],
    'sca': [664],
    'viv': [666],
    'pyr': [668],
    'gog': [673],
    'dou': [680],
    'aeg': [681],
    'spr': [682, 906],
    'ink': [686],
    'mal': [687],
    'bin': [688],
    'skr': [690],
    'hel': [694, 695],
    'ama': [698],
    'aur': [699],
    'syl': [700],
    'haw': [701],
    'ded': [702],
    'goo': [704, 706],
    'sli': [705, 988],
    'kle': [707, 900],
    'pum': [710],
    'gou': [711],
    'ber': [712],
    'ava': [713],
    'noi': [714, 715],
    'xer': [716],
    'yve': [717],
    'zyg': [718],
    'row': [722],
    'dec': [724],
    'inc': [727],
    'pop': [728],
    'bri': [729],
    'tou': [733],
    'yun': [734],
    'gum': [735],
    'vik': [738],
    'ori': [741],
    'cut': [742],
    'rib': [743],
    'roc': [744],
    'lyc': [745],
    'wis': [746],
    'ara': [752],
    'fom': [753],
    'lur': [754],
    'mor': [755, 860, 877],
    'bew': [760],
    'tsa': [763],
    'ora': [765],
    'pas': [766],
    'wim': [767],
    'pyu': [771],
    'kom': [775, 784],
    'bru': [779, 986],
    'dhe': [781],
    'jan': [782],
    'hak': [783],
    'tap': [785, 786, 787, 788],
    'cos': [789, 790],
    'nih': [793],
    'buz': [794],
    'phe': [795],
    'xur': [796],
    'guz': [799],
    'nec': [800],
    'poi': [803],
    'nag': [804],
    'zer': [807],
    'thw': [811],
    'ril': [812],
    'rab': [814, 954],
    'sob': [816],
    'int': [818],
    'skw': [819],
    'roo': [821],
    'dot': [825],
    'orb': [826],
    'nic': [827],
    'thi': [828],
    'gos': [829],
    'eld': [830],
    'dub': [832],
    'dre': [834, 885],
    'rol': [837],
    'coa': [839],
    'app': [840, 842],
    'arr': [846],
    'siz': [850],
    'cen': [851],
    'sin': [854, 1013],
    'hat': [856, 857, 858],
    'imp': [859],
    'obs': [862],
    'cur': [864],
    'sir': [865],
    'run': [867],
    'alc': [869],
    'fal': [870],
    'eis': [875],
    'ind': [876],
    'cuf': [878],
    'cop': [879],
    'zac': [888],
    'zam': [889],
    'ete': [890],
    'kub': [891],
    'zar': [893],
    'cal': [898],
    'wyr': [899],
    'ove': [904],
    'ena': [905],
    'fue': [909],
    'ske': [911],
    'lec': [915],
    'oin': [916],
    'tar': [917],
    'nym': [919],
    'lok': [920],
    'mau': [925],
    'fid': [926],
    'dac': [927],
    'dol': [929],
    'nac': [932, 933],
    'cer': [937],
    'tad': [938],
    'kil': [941],
    'mab': [943],
    'toe': [948, 949],
    'cap': [951],
    'fli': [955],
    'tin': [957, 958, 959, 1003],
    'wug': [961],
    'bom': [962],
    'var': [965],
    'rev': [966],
    'cyc': [967],
    'ort': [968],
    'cet': [974, 975],
    'vel': [976],
    'tat': [978],
    'ann': [979],
    'dud': [982],
    'flu': [987],
    'iro': [990, 991, 992, 993, 994, 995, 1006, 1010],
    'bax': [998],
    'gim': [999],
    'gho': [1000],
    'wo-': [1001],
    'roa': [1005],
    'kor': [1007],
    'mir': [1008],
    'dip': [1011],
    'oki': [1014],
    'fez': [1016],
    'oge': [1017]
}
TWO_GRAMS = dict()
ONE_GRAMS = dict()
for k, v in THREE_GRAMS.items():
    two_list = TWO_GRAMS.get(k[:2], [])
    one_list = ONE_GRAMS.get(k[:1], [])
    TWO_GRAMS[k[:2]] = two_list + v
    ONE_GRAMS[k[:1]] = one_list + v

def update_globals(dexn, name):
    global THREE_GRAMS, TWO_GRAMS, ONE_GRAMS, DEX_DICT

    three = THREE_GRAMS.get(name[:3], [])
    two = TWO_GRAMS.get(name[:2], [])
    one = ONE_GRAMS.get(name[:1], [])
    if dexn not in three:
        THREE_GRAMS[name[:3]] = three + [dexn]
    if dexn not in two:
        TWO_GRAMS[name[:2]] = two + [dexn]
    if dexn not in one:
        ONE_GRAMS[name[:1]] = one + [dexn]
    DEX_DICT[dexn] = name

def to_server(port, module, scope):
    config = uvicorn.Config(**{
        "port": port,
        "reload": True,
        "host": "0.0.0.0",
        "app": f"{module}:{scope}_{module}"
    })
    return uvicorn.Server(config)


async def run_server(server):
    await server.serve()


async def run_tasks():

    loop = asyncio.get_event_loop()
    api_server = to_server(API_PORT, 'api', 'pd')
    client_server = to_server(CLIENT_PORT, 'client', 'pd')
    api_task = asyncio.ensure_future(run_server(api_server))
    client_task = asyncio.ensure_future(run_server(client_server))

    async def cancel():
        await api_server.shutdown()
        await client_server.shutdown()
        sys.exit(0)

    tasks = [api_task, client_task]
    # https://github.com/encode/uvicorn/pull/1600
    for job in asyncio.as_completed(tasks):
        try:
            results = await job
        finally:
            await cancel()

if __name__ == "__main__":


    N_DEX = len(DEX_DICT) 
    print('Updating Pokédex...', flush=True, file=sys.stderr)
    while True:
        try:
            dexn = N_DEX + 1
            pkmn = dex.get(dex=(dexn))
            print(f'New: Pokémon #{dexn} {pkmn.name}')
            update_globals(dexn, pkmn.name)
        except PyPokedexHTTPError:
            break
        N_DEX += 1

    args = parser.parse_args()
    # Configure API
    set_config(**{
        **vars(args), 'ports': PORTS,
        'api_url': 'https://pokeapi.co/api/v2/',
        'dex_dict': DEX_DICT, 'one_grams': ONE_GRAMS,
        'two_grams': TWO_GRAMS, 'three_grams': THREE_GRAMS,
        'ndex': N_DEX,
    })

    # Test the API
    asyncio.run(run_tasks())
